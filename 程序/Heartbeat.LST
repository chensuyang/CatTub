C51 COMPILER V9.52.0.0   HEARTBEAT                                                         02/22/2018 18:27:58 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE HEARTBEAT
OBJECT MODULE PLACED IN Heartbeat.OBJ
COMPILER INVOKED BY: C:\Keil_v4\C51\BIN\C51.EXE Heartbeat.c LARGE OPTIMIZE(2,SIZE) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          #include "Heartbeat.h"
   2          #include "stc15.h"
   3          #include "timer0.h"
   4          #include "tm1620.h"
   5          #include "ds18b20.h"
   6          #include "EEPROM.h"
   7          #include "buzzer.h"
   8          float Set_Temperature=0;//设定温度
   9          bit IsTemperatureSetMode=0;//处于设定温度模式
  10          unsigned int TemperatureSetModeTimeOutCnt=0;//设定温度模式超时计数
  11          
  12          void HeartBeat_Init(void)//初始化系统心跳
  13          {
  14   1        Timer0_Init();//初始化定时器0
  15   1        Set_Temperature=EEPROM_Read_SetTemperature();//读取设定温度值
  16   1      }
  17          
  18          
  19          
  20          void HeartBeat_IRQ(void)//系统心跳中断
  21          {
  22   1        Buzzer_Tweet_HeartBeat_IRQ();//蜂鸣器鸣叫系统心跳处理函数
  23   1        DS18B20_HeartBeat_IRQ();//DS18B20系统心跳处理函数
  24   1        if(!IsTemperatureSetMode)//如果不是在设定温度模式(日常温度显示状态)
  25   1        {
  26   2          TM1620_Show_Temperature(DS18B20_Get_New_Temperature());//显示最新实时温度
  27   2          TM1620_Write_Digitron_Data(3,0x00);//不点亮温度设置模式LED
  28   2          TM1620_display_on(3);//发出显示
  29   2        }
  30   1        else
  31   1        {
  32   2          TM1620_Show_Temperature(Set_Temperature);//显示设置温度
  33   2          //TM1620_Write_Digitron_Data(3,0x80);//点亮温度设置模式LED
  34   2          TM1620_display_on(3);//发出显示
  35   2          TemperatureSetModeTimeOutCnt++;//设定温度模式超时计数++
  36   2          if(TemperatureSetModeTimeOutCnt>150)//如果设定温度模式超时计数大于1.5秒
  37   2          {
  38   3            TemperatureSetModeTimeOutCnt=0;//清空计数
  39   3            IsTemperatureSetMode=0;//退出设定温度模式
  40   3          }
  41   2        }
  42   1        
  43   1      }
  44          
  45          void TemperatureSetMode_SetUP(void)//设置温度上升一度
  46          {
  47   1        IsTemperatureSetMode=1;//设置当前为设置温度模式
  48   1        TemperatureSetModeTimeOutCnt=0;//清空设置温度模式的超时计数(重新开始算超时时间)
  49   1        if(Set_Temperature<55)Set_Temperature++;
  50   1        EEPROM_Write_SetTemperature(Set_Temperature);
  51   1      }
  52          
  53          void TemperatureSetMode_SetDOWN(void)//设置温度下降一度
  54          {
  55   1        IsTemperatureSetMode=1;//设置当前为设置温度模式
C51 COMPILER V9.52.0.0   HEARTBEAT                                                         02/22/2018 18:27:58 PAGE 2   

  56   1        TemperatureSetModeTimeOutCnt=0;//清空设置温度模式的超时计数(重新开始算超时时间)
  57   1        if(Set_Temperature>10)Set_Temperature--;
  58   1        EEPROM_Write_SetTemperature(Set_Temperature);
  59   1      }
  60          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    219    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      6    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
